---
created: 2025-11-08
tags: [howto, nextjs, setup, turbopack]
status: 完了
---

# Next.js 16 セットアップガイド

## 概要

Next.js 16 プロジェクトのセットアップ手順と動作確認の記録。

## プロジェクト作成

### コマンド

```bash
cd ~/study/ob-dev/Projects
npx create-next-app@latest next16-sandbox --typescript --tailwind --app --yes
```

### オプション説明

- `--typescript`: TypeScriptを使用
- `--tailwind`: Tailwind CSSを使用
- `--app`: App Routerを使用（Next.js 13+のデフォルト）
- `--yes`: すべてのプロンプトに自動的にyesで回答

## インストールされたバージョン

```json
{
  "dependencies": {
    "react": "19.2.0",
    "react-dom": "19.2.0",
    "next": "16.0.1"
  },
  "devDependencies": {
    "typescript": "^5",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "@tailwindcss/postcss": "^4",
    "tailwindcss": "^4",
    "eslint": "^9",
    "eslint-config-next": "16.0.1"
  }
}
```

### 注目ポイント

- **Next.js 16.0.1**: 最新バージョン
- **React 19.2.0**: React Compiler対応バージョン
- **Tailwind CSS 4**: 最新メジャーバージョン
- **TypeScript 5**: 最新の型システム

## プロジェクト構造

```
next16-sandbox/
├── app/                    # App Router
│   ├── favicon.ico
│   ├── globals.css
│   ├── layout.tsx         # ルートレイアウト
│   └── page.tsx           # ホームページ
├── public/                # 静的ファイル
├── node_modules/
├── .next/                 # ビルド出力
├── next.config.ts         # Next.js設定
├── tsconfig.json          # TypeScript設定
├── tailwind.config.ts     # Tailwind設定（v4ではpostcss.config.mjs）
├── postcss.config.mjs     # PostCSS設定
├── eslint.config.mjs      # ESLint設定
├── package.json
└── README.md
```

## Turbopack動作確認

### 開発サーバー起動

```bash
cd Projects/next16-sandbox
npm run dev
```

### 起動結果

```
▲ Next.js 16.0.1 (Turbopack)
- Local:        http://localhost:3000
- Network:      http://192.168.128.71:3000

✓ Starting...
✓ Ready in 385ms
```

### パフォーマンス

- **起動時間**: わずか385ms
- **ビルドツール**: Turbopack（デフォルト）
- **HMR（Hot Module Replacement）**: 有効

## 基本設定の確認

### layout.tsx

```typescript
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}
```

**特徴**:
- Google Fontsの最適化読み込み（Geist、Geist Mono）
- メタデータのエクスポート
- CSS変数を使ったフォント設定

### next.config.ts

```typescript
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;
```

**デフォルト設定**:
- Turbopackは自動的に有効（Next.js 16）
- 追加設定なしでも最適化済み

## Next.js 16の新機能

### 1. Turbopack（デフォルト化）

- Webpackに代わる高速ビルドツール
- Rustで実装
- インクリメンタルビルド
- 大幅な起動時間の短縮

### 2. `use cache` ディレクティブ

```typescript
"use cache";

export default async function Page() {
  // このページ全体がキャッシュされる
}
```

### 3. Async Request APIs

```typescript
// params, searchParamsが非同期に
async function Page({ params }: { params: Promise<{ id: string }> }) {
  const { id } = await params;
}
```

### 4. React 19.2統合

- React Compiler対応
- 自動メモ化
- useOptimistic、useFormStatusなど

## トラブルシューティング

### よくある問題

#### 1. ポート3000が使用中

```bash
# ポートを変更して起動
PORT=3001 npm run dev
```

#### 2. node_modulesの問題

```bash
# クリーンインストール
rm -rf node_modules package-lock.json
npm install
```

#### 3. キャッシュのクリア

```bash
# .nextディレクトリを削除
rm -rf .next
npm run dev
```

## 次のステップ

1. ✅ プロジェクトセットアップ完了
2. ⏭️ Cache Components実装（`use cache`）
3. ⏭️ Async Params実装
4. ⏭️ View Transitions実装

## 参考リンク

- [Next.js 16 公式ドキュメント](https://nextjs.org/docs)
- [Turbopack ドキュメント](https://turbo.build/pack/docs)
- [React 19 リリースノート](https://react.dev/blog)

---

**作成日**: 2025-11-08
**プロジェクトパス**: `~/study/ob-dev/Projects/next16-sandbox/`
