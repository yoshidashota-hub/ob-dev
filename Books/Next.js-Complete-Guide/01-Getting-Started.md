# 01 - Getting Started

## 概要

この章では、Next.js の開発環境をセットアップし、最初のプロジェクトを作成します。

## 前提条件

### Node.js のインストール

Next.js 15 には **Node.js 18.17 以上**が必要です。

```bash
# バージョン確認
node --version
# v18.17.0 以上であること

# npm のバージョン確認
npm --version
```

### 推奨バージョン

- **Node.js**: 20.x LTS（推奨）
- **npm**: 10.x 以上
- **pnpm**: 8.x 以上（代替）

### Node.js のインストール方法

#### macOS（Homebrew）

```bash
brew install node@20
```

#### Windows（公式インストーラー）

[Node.js 公式サイト](https://nodejs.org/)から LTS 版をダウンロード

#### nvm を使用（推奨）

```bash
# nvm のインストール（まだの場合）
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Node.js 20 のインストール
nvm install 20
nvm use 20
```

## プロジェクトの作成

### create-next-app

Next.js プロジェクトを作成する最も簡単な方法です:

```bash
npx create-next-app@latest my-app
```

### インタラクティブな設定

コマンドを実行すると、以下の質問が表示されます:

```
✔ Would you like to use TypeScript? … Yes
✔ Would you like to use ESLint? … Yes
✔ Would you like to use Tailwind CSS? … Yes
✔ Would you like your code inside a `src/` directory? … No
✔ Would you like to use App Router? (recommended) … Yes
✔ Would you like to use Turbopack for next dev? … Yes
✔ Would you like to customize the import alias (@/*)? … No
```

### 推奨設定

| 設定項目       | 推奨値 | 理由                                       |
| -------------- | ------ | ------------------------------------------ |
| TypeScript     | Yes    | 型安全性、IDE サポート                     |
| ESLint         | Yes    | コード品質の維持                           |
| Tailwind CSS   | Yes    | 高速なスタイリング                         |
| src/ directory | No     | シンプルな構造（大規模プロジェクトは Yes） |
| App Router     | Yes    | 最新のルーティングシステム                 |
| Turbopack      | Yes    | 高速な開発サーバー                         |
| Import alias   | No     | デフォルトの `@/*` で十分                  |

### ワンライナーでの作成

設定を省略したい場合:

```bash
# すべてデフォルト（推奨設定）で作成
npx create-next-app@latest my-app --typescript --tailwind --eslint --app --turbopack

# 最小構成
npx create-next-app@latest my-app --typescript --eslint --app
```

## プロジェクト構造

作成されたプロジェクトの構造:

```
my-app/
├── app/                    # App Router のルートディレクトリ
│   ├── favicon.ico        # ファビコン
│   ├── globals.css        # グローバルスタイル
│   ├── layout.tsx         # ルートレイアウト
│   └── page.tsx           # ホームページ
├── public/                 # 静的ファイル
│   ├── file.svg
│   ├── globe.svg
│   ├── next.svg
│   ├── vercel.svg
│   └── window.svg
├── .eslintrc.json         # ESLint 設定
├── .gitignore             # Git 除外設定
├── next-env.d.ts          # TypeScript 型定義
├── next.config.ts         # Next.js 設定
├── package.json           # プロジェクト設定
├── postcss.config.mjs     # PostCSS 設定（Tailwind用）
├── tailwind.config.ts     # Tailwind CSS 設定
├── tsconfig.json          # TypeScript 設定
└── README.md              # プロジェクト説明
```

### 主要ファイルの説明

#### `app/layout.tsx`

ルートレイアウト - すべてのページで共有される:

```typescript
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}
```

**ポイント**:

- `html` と `body` タグを含む必須のレイアウト
- `metadata` でページのメタ情報を設定
- `children` で子ページをレンダリング

#### `app/page.tsx`

ホームページ（`/` ルート）:

```typescript
export default function Home() {
  return (
    <main>
      <h1>Welcome to Next.js!</h1>
    </main>
  );
}
```

#### `next.config.ts`

Next.js の設定ファイル:

```typescript
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;
```

## 開発サーバーの起動

### 基本コマンド

```bash
cd my-app
npm run dev
```

### 出力

```
   ▲ Next.js 15.x.x
   - Local:        http://localhost:3000
   - Environments: .env.local

 ✓ Starting...
 ✓ Ready in 2.5s
```

ブラウザで `http://localhost:3000` を開くと、初期ページが表示されます。

### Turbopack について

Next.js 15 では Turbopack がデフォルトで有効です:

- **高速な起動**: Webpack より最大 10 倍高速
- **高速な HMR**: 変更が即座に反映
- **メモリ効率**: より少ないメモリ使用量

```bash
# Turbopack を明示的に使用（デフォルト）
npm run dev -- --turbo

# Webpack を使用したい場合
npm run dev -- --no-turbo
```

## スクリプトの説明

`package.json` のスクリプト:

```json
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

| スクリプト | 説明                           |
| ---------- | ------------------------------ |
| `dev`      | 開発サーバーを起動（HMR 有効） |
| `build`    | 本番用にビルド                 |
| `start`    | ビルド済みアプリを起動         |
| `lint`     | ESLint でコードをチェック      |

### よく使うコマンド

```bash
# 開発
npm run dev

# 本番ビルド
npm run build

# 本番サーバー起動（ビルド後）
npm run start

# Lint チェック
npm run lint

# Lint 自動修正
npm run lint -- --fix

# ポート指定
npm run dev -- -p 3001
```

## 最初のページを編集

### Hello World

`app/page.tsx` を編集:

```typescript
export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <h1 className="text-4xl font-bold">Hello, Next.js!</h1>
      <p className="mt-4 text-xl text-gray-600">
        Welcome to your first Next.js application
      </p>
    </main>
  );
}
```

ファイルを保存すると、ブラウザが自動で更新されます（Hot Module Replacement）。

### 画像を追加

`public/` ディレクトリに画像を配置:

```bash
# 例: public/hero.png を配置
```

```typescript
import Image from "next/image";

export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <Image
        src="/hero.png"
        alt="Hero image"
        width={300}
        height={200}
        priority
      />
      <h1 className="text-4xl font-bold mt-8">Hello, Next.js!</h1>
    </main>
  );
}
```

## 環境変数

### 環境変数ファイル

```bash
# .env.local（ローカル開発用、.gitignore に含まれる）
DATABASE_URL=postgresql://localhost:5432/mydb
API_KEY=your-secret-key

# クライアントに公開する場合は NEXT_PUBLIC_ プレフィックス
NEXT_PUBLIC_API_URL=https://api.example.com
```

### 使用方法

```typescript
// サーバーサイドのみ
const dbUrl = process.env.DATABASE_URL;

// クライアントサイドでも使用可能
const apiUrl = process.env.NEXT_PUBLIC_API_URL;
```

### 環境変数の優先順位

1. `.env.local` - ローカル上書き（最優先）
2. `.env.development` / `.env.production` - 環境別
3. `.env` - デフォルト

## TypeScript の設定

### tsconfig.json

```json
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### パスエイリアス

`@/*` エイリアスで簡潔なインポート:

```typescript
// 相対パス（煩雑）
import { Button } from "../../../components/Button";

// パスエイリアス（推奨）
import { Button } from "@/components/Button";
```

## ESLint の設定

### .eslintrc.json

```json
{
  "extends": ["next/core-web-vitals", "next/typescript"]
}
```

### 追加のルール（推奨）

```json
{
  "extends": ["next/core-web-vitals", "next/typescript"],
  "rules": {
    "@typescript-eslint/no-unused-vars": "warn",
    "@typescript-eslint/no-explicit-any": "warn",
    "react/no-unescaped-entities": "off"
  }
}
```

## VS Code の設定

### 推奨拡張機能

`.vscode/extensions.json`:

```json
{
  "recommendations": [
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "formulahendry.auto-rename-tag"
  ]
}
```

### ワークスペース設定

`.vscode/settings.json`:

```json
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "explicit"
  },
  "tailwindCSS.experimental.classRegex": [
    ["cva\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"]
  ]
}
```

## Prettier の設定（オプション）

### インストール

```bash
npm install -D prettier prettier-plugin-tailwindcss
```

### .prettierrc

```json
{
  "semi": true,
  "singleQuote": false,
  "tabWidth": 2,
  "trailingComma": "es5",
  "plugins": ["prettier-plugin-tailwindcss"]
}
```

## トラブルシューティング

### ポートが使用中

```bash
# ポート 3000 が使用中の場合
npm run dev -- -p 3001
```

### node_modules の問題

```bash
# node_modules を再インストール
rm -rf node_modules
rm -rf .next
npm install
```

### TypeScript エラー

```bash
# 型チェック
npx tsc --noEmit

# キャッシュクリア
rm -rf .next
npm run dev
```

### ESLint エラー

```bash
# 自動修正
npm run lint -- --fix
```

## まとめ

- **Node.js 18.17 以上**が必要
- `create-next-app` でプロジェクトを作成
- **App Router** と **TypeScript** を使用（推奨）
- `npm run dev` で開発サーバーを起動
- `app/` ディレクトリがルーティングの基点
- **Turbopack** がデフォルトで有効（高速な開発体験）

## 演習問題

1. 新しい Next.js プロジェクトを作成してください
2. `app/page.tsx` を編集して、自分の名前を表示してください
3. Tailwind CSS を使ってスタイルを適用してください
4. `.env.local` ファイルを作成し、環境変数を設定してください

## 次のステップ

次の章では、App Router の基本概念とファイル規約について学びます。

⬅️ 前へ: [00-Introduction.md](./00-Introduction.md)
➡️ 次へ: [02-App-Router-Basics.md](./02-App-Router-Basics.md)
